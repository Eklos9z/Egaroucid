# Egaroucid 使い方

オセロAI Egaroucidの公式ドキュメントです。このページの内容は最新バージョンに合わせてありますが、更新が追いつかない場合もあります。

このページは日本語のみです。

INSERT_TABLE_OF_CONTENTS_HERE

## 画面の見方

画面の見方を5つの項目に分けて解説します。

<div class="centering_box">
    <img class="pic2" src="img/screen.png">
</div>

### 盤面

オセロの盤面です。合法手(打てるところ)の表示や評価値などの表示もできます。マスを直接クリックすることで着手できます。

<ul>
    <li>評価値を表示できます</li>
    <li>うみがめ数を表示できます</li>
    <li>棋譜、盤面などによる入出力ができます</li>
    <li>盤面だけを切り取ったスクリーンショットを撮る機能があります</li>
</ul>

### 対局情報

盤面やAIに関係する情報をまとめて表示しています。

現在が何手目で、誰の手番なのか、現在の石数はいくつ対いくつなのか、定石名は何か、AIのレベルはいくつか、を表示しています。

### グラフ

対局の形勢を表すグラフを表示します。

横軸が手数(0手目から60手目まで)で、縦軸が形勢(石差)です。

グラフは真ん中の0で互角、上に行くと黒有利、下に行くと白有利です。

<ul>
    <li>対局中など、グラフを見たくないときには非表示にできます</li>
    <li><a href="#対局_分析">対局の解析を行うと全ての局面の値をまとめて計算できます</a></li>
    <li>ヒントを表示した上で盤面を進めていくと自動で更新されます</li>
</ul>


### メニュー

各種操作を行います。

様々な機能がついているので、このサイトではメニューの構成に沿って機能を紹介します。

### ログ

AIの計算過程などを表示します。ユーザはあまり気にしなくて良いですが、なにか不具合があった場合の解決策のヒントになる場合があります。

<ul>
    <li><a href="#表示_ログ">ログ表示をオフにできます</a></li>
</ul>



## 対局

メニューのここから辿れる機能です。

<div class="centering_box">
    <img class="pic2" src="img/menu_game.png">
</div>

### 新規対局 (人間同士)

盤面を初期状態に戻します。AIが着手しない設定なので、そのまま人間が打ち進めます。石を並べる際や人間同士の対局で使うことを想定しています。

<ul>
    <li><a href="#設定_AIの着手設定">途中からAIに打たせることもできます</a></li>
</ul>


### 新規対局 (人間黒番)

盤面を初期状態に戻し、人間が黒番、AIが白番で対戦します。対局用途にも使えますが、ただ石を並べる用途を考えています。

<ul>
    <li><a href="#設定_AIの着手設定">途中からAIが着手する手番を変更できます</a></li>
    <li><a href="#設定_AIの着手設定">途中から人間同士/AI同士に設定できます</a></li>
</ul>


### 新規対局 (人間白番)

盤面を初期状態に戻し、AIが黒番、人間が白番で対戦します。

AIが初手なので、画面右上に対局開始ボタンが出現します。それを押すと対局が始まります。

<div class="centering_box">
    <img class="pic2" src="img/game_start_game_button.png">
</div>
<ul>
    <li><a href="#設定_AIの着手設定">途中からAIが着手する手番を変更できます</a></li>
    <li><a href="#設定_AIの着手設定">途中から人間同士/AI同士に設定できます</a></li>
</ul>


### 新規自己対戦

盤面を初期状態に戻し、AI同士で対戦します。

画面右上に対局開始ボタンが出現します。それを押すと対局が始まります。

<div class="centering_box">
    <img class="pic2" src="img/game_start_game_button.png">
</div>
<ul>
    <li><a href="#設定_AIの着手設定">途中からAIが着手する手番を変更できます</a></li>
    <li><a href="#設定_AIの着手設定">途中から人間同士/AI同士に設定できます</a></li>
</ul>


### 分析

対局を分析します。

1手ずつ評価値を再計算して、グラフに描画します。どこで悪手を打ったのかがわかりやすいです。



## 設定

メニューのここから辿れる機能です。

<div class="centering_box">
    <img class="pic2" src="img/settings.png">
</div>



### book使用

AIの着手やヒント計算にbookを使うか否かを選択できます。

bookとは、予め局面に対して評価値を計算しておいたものです。

<ul>
    <li>bookを自動で拡張できます</li>
    <li>bookを手動で修正できます</li>
    <li>bookのファイル指定ができます</li>
    <li>bookの統合ができます</li>
</ul>

### book変化レベル

bookには最善手以外の手も収録されています。AIの着手時にそのような悪手をどれくらいの確率で打つかを決められます。

book変化レベルが0だと最善手しか打ちません。値が大きくなると悪手を積極的に打つようになります。

最大でbook変化レベルの2倍の石損を許すという意図の設定です。ただ、石損が大きい手は選ぶ確率が低いです。

具体的な計算手法は以下です。

book変化レベルが$X$で、ある局面から手を選択するとき、bookに登録されている着手の評価値の集合を$A=\{(v,m)\}$とします。ここで、$v$は(手番目線の)評価値、$m$は手です。

$B=\left\{(v,m)\in A\middle|v\geq v_{\mathrm{max}}-2X\right\}$

で定義される$B$を作り、$2X$石損以下の手を厳選します。なお、$v_{\mathrm{max}}$は最善手の評価値です。そして

$C=\left\{(s,m)\middle| s=\left(\exp\left(\frac{v-v_{\mathrm{max}}+1.5}{3}\right)\right)^{(10-X)}\right\}$

$D=\left\{(s,m)\middle| s=\frac{s}{c_{\mathrm{sum}}}\right\}$

softmax的に変換します。$c_{\mathrm{sum}}$は$C$の$s$の合計値です。

そしてここで$r$を0以上1未満のランダムな値として、

$r\leq\sum_{j=0}^{i}{s'_j}$

かつ

$r>\sum_{j=0}^{i-1}{s'_j}$

を満たす$i$を見つけ、$M_i$を着手する手として採用します。

### レベル

AIのレベルを設定できます。

AIのレベルは、

<ul>
    <li>中盤の読みの深さ</li>
    <li>終盤の読み切りタイミング</li>
    <li>探索の精度の確率</li>
</ul>

という3つの観点で定義されます。レベルを上げると、中盤は深くまで読み、終盤の読み切りタイミングは早く、探索の精度の確率は上がります。

ここで設定するレベルは、<a href="#設定_AIの着手設定">AIの着手</a>、ヒント表示、<a href="#対局_分析">対局分析</a>、Book学習の全てで統一して使われます。

「探索の精度の確率」と書いたのは、Multi-ProbCutという技術で用いられる確率のことです。Multi-ProbCutは、明らかな悪手の探索を省略するものです。確率が低ければ大胆に、確率が高ければ少しだけ省略します。なお、100%の場合は探索を省略しません。

### スレッド数

ここでは、並列計算についての設定をします。

お使いのCPUが$X$コア$Y$スレッドであれば、$Y$に近い値に設定すると高速になると思います。

デフォルトで$Y$に自動的に設定されるようになっています。

### ハッシュレベル

Egaroucidでは探索時に、一部の探索結果を保存しておきます。その保存領域の大きさを決められます。大きくするとメモリ消費量が増え、探索が高速になる可能性が高まります。

ハッシュレベルを$X$とすると、この保存領域において以下の表で示されるメモリを消費します。

<table>
<tr>
<th>ハッシュレベル$X$</th>
<th>メモリ消費量(GB)</th>
</tr>
<tr>
<td>23</td>
<td>0.75</td>
</tr>
<tr>
<td>24</td>
<td>0.75</td>
</tr>
<tr>
<td>25</td>
<td>0.75</td>
</tr>
<td>26</td>
<td>1.5</td>
</tr>
<td>27</td>
<td>3.0</td>
</tr>
</table>

内部的には、$2^X$個の局面を保存できるようにする大きさのハッシュテーブルを作っています。

### AIの着手設定

「AIが黒に着手」「AIが白に着手」によって、対局中でもAIの着手設定を変更できます。

両方のチェックを外せば途中から人間同士の対局(ただ石を並べるだけ)になります。

<ul>
    <li><a href="#対局">対局開始時に1クリックで設定できます</a></li>
</ul>

### パスで一時停止

人間とAIの対局で、人間のパスの時に人間が明示的にパスであるというボタンを押すかどうかの設定です。



## 表示

メニューのここから辿れる機能です。

<div class="centering_box">
    <img class="pic2" src="img/display.png">
</div>

### 合法手への表示 > 合法手

### 合法手への表示 > 石差評価

### 合法手への表示 > うみがめ数

### 合法手への表示 > 定石

### 石への表示 > 直前の手

### 石への表示 > 直後の手

### 石への表示 > 確定石

### グラフ

### ログ



## 操作

### 進む/戻る/待った

### この分岐を保存

### 変換

### 計算停止 (AI操作)

### キャッシュクリア (AI操作)



## 入出力

### 入力 > 棋譜入力

### 入力 > 盤面入力

### 入力 > 盤面編集

### 入力 > 対局読み込み

### 出力 > 現局面までの棋譜をコピー

### 出力 > 対局保存

### 出力 > スクリーンショット

### 出力 > ボードの画像を編集



## Book

### 学習の設定 > 深さ

### 学習の設定 > 1手あたりの誤差

### 学習の設定 > 手筋の合計誤差

### Book操作 > 右クリックで編集

### Book操作 > Book拡張

### Book操作 > Book修正

### Book操作 > 深さ上限設定

### Book操作 > レベル上書き

### ファイル操作 > 統合

### ファイル操作 > bookの参照

### ファイル操作 > Edax形式で保存



## ヘルプ

### 使い方

このページへ飛べるボタンです。

### Webサイト

Egaroucid公式サイトのトップページに飛べるボタンです。

### バグレポート

バグ報告や機能追加依頼などができるGoogleフォームに飛べるボタンです。

### 自動更新確認

Egaroucidの起動時に更新を自動で確認するかを選択できます。

Egaroucidは過去バージョンとの互換性を極力高めて開発しており、最新バージョンでは様々なバグを解消していますので、常に最新バージョンへのアップデートを推奨します。

### Egaroucid/Siv3Dのライセンス

Egaroucidのライセンス、およびEgaroucidで使用しているライブラリであるSiv3Dのライセンスを表示できます。

